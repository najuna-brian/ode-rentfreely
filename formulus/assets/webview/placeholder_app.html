<!DOCTYPE html>
<html>
  <head>
    <title>Custom App Placeholder</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
      body { font-family: sans-serif; text-align: center; padding: 40px; }
      h1 { color: #4A90E2; }
    </style>
  </head>
  <body>
    <h1>Your Custom App</h1>
    <p>This is a placeholder. Your app will appear here after sync.</p>
    <script>
    (function() {
      function waitForFormulus(cb, tries = 50) {
        const api = window.formulus || globalThis.formulus;
        if (api && typeof api.getVersion === 'function') {
          try {
            const version = api.getVersion();
            
            // Check if it's a Promise
            if (version instanceof Promise) {
              version.then(function(v) {
                console.log('Formulus version:', v);
                document.body.insertAdjacentHTML('beforeend', '<p>Formulus version: ' + v + '</p>');
                cb();
              }).catch(function(err) {
                console.error('Error awaiting version:', err);
                document.body.insertAdjacentHTML('beforeend', '<p style="color: #999;">Formulus API: Error</p>');
              });
            } else {
              console.log('Formulus version:', version);
              document.body.insertAdjacentHTML('beforeend', '<p>Formulus version: ' + version + '</p>');
              cb();
            }
          } catch (err) {
            console.error('Error getting Formulus version:', err);
            document.body.insertAdjacentHTML('beforeend', '<p style="color: #999;">Formulus API: Error</p>');
          }
        } else if (tries > 0) {
          setTimeout(() => waitForFormulus(cb, tries - 1), 100);
        } else {
          console.warn('Formulus API not available after waiting');
          document.body.insertAdjacentHTML('beforeend', '<p style="color: #999;">Formulus API: Not available</p>');
        }
      }
      
      document.addEventListener('DOMContentLoaded', function() {
        waitForFormulus(function() {
          // API loaded successfully
        });
      });
    })();
    </script>
  </body>
</html>
